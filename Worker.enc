
module Worker

class Worker[t]
  var data : [t]
  var size : int
  var id : int
  var startindex : int

  def init(data:[t]) : unit
    this.data = data
    this.size = |data|
  end

  def atindex(index: int) : t
      this.data(index)
  end

  def applyto(index:int, f : t -> t) : unit
      this.data(index) = f(this.data(index))
  end

  def map(f: t->t) : unit
    repeat i <- this.size do
      this.data(i) = f(this.data(i))
    end
  end

  def toarray() : [t]
      this.data
  end

  def insert(index: int, value: t) : unit
      this.size = this.size + 1
      var newarray = new[t](this.size)

      var oldi = 0
      repeat i <- this.size do
          if(i == index) then
              newarray(i) = value
          else
              newarray(i) = this.data(oldi)
              oldi +=1
          end
      end

      this.data = newarray
  end

  def delete(index: int) : unit
      this.size = this.size - 1
      var newarray = new[t](this.size)

      var oldi = 0
      repeat i <- this.size do
          if(i == index) then
              oldi +=1
              newarray(i) = this.data(oldi)
          else
              newarray(i) = this.data(oldi)
          end
          oldi +=1
      end

      this.data = newarray
  end

  def push(value:t) : unit
      this.size = this.size + 1
      var newarray = new[t](this.size)

      repeat i <- this.size do
          if(i == this.size-1) then
              newarray(i) = value
          else
              newarray(i) = this.data(i)
          end
      end

      this.data = newarray
  end
end
