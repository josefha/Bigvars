
module HashEntry

import LinkedList

local class HashEntry[k,v]
    var key : k
    var values : LinkedList[v]
    var hasEntry : bool

    def init() : unit
        this.hasEntry = false
        this.values = new LinkedList[v]()
    end

    def add(key:k,value:v) : unit
        this.hasEntry = true
        this.key = key
        this.values = new LinkedList[v]()
        this.values.append(value)
    end

    def notEmpty() : bool
        this.hasEntry
    end

    def getKey() : k
        this.key
    end

    def getValue() : v
        match this.values.first with
            case Just(node) =>
                node.value
            end
        end
    end

    -- Functions to use for MapRedece Framwork

    def extend(value:v) : unit
        this.hasEntry = true
        this.values.append(value)
    end

    def extendAll(values:[v]) : unit
        this.values.append_all(values)
    end
    --
    def getValues() : [v]
        var elements = new[v](this.values.size())
        repeat i <- this.values.size() do
            match this.values.element_at(i) with
                case Just(element) => elements(i) = element
            end
        end
        elements
    end
end
