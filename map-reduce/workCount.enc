


active class WordCount
    def mapper(key:String,value:String) : [(String,int)]
        var words = value.split(" ")
        result = new[(int,String)](len(words))
        repeat i in words do
            result(i) = (words(i),1)
        end
        result
    end

    def reducer(key:String,values:[int]) : (String,int)
        sum = 0
        for value in values:
            sum += value
        end
        (key,sum)
    end
end
